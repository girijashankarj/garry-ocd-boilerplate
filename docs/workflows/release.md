# Release Workflow

Introduction
This document defines how a release is approved, built, and deployed using Garry’s standards. It applies to both frontend and backend templates.

## Contents
- Scope and goals
- Release roles and responsibilities
- Release readiness checklist
- Versioning and changesets
- Release flow (ASCII)
- Rollback rules
- Evidence and artifacts
- References
- Last updated

## Scope and goals
Goals
- Ensure every release is traceable to commits and changesets.
- Prevent releasing without tests, lint, and test:structure passing.
- Provide a repeatable approval and rollback process.

Scope
- Frontend and backend templates generated by this scaffolder.
- Applies to `main` branch releases only.

## Release roles and responsibilities
Manager
- Approves scope and release window.
- Confirms business sign‑off and priority alignment.

QA
- Validates release candidate against acceptance criteria.
- Confirms no blockers in regression suite.

DevOps
- Executes deploy steps.
- Verifies environment variables and secrets are injected.

Developer
- Ensures changesets are complete and accurate.
- Fixes failing checks before release.

## Release readiness checklist
Code quality
- Lint passes with zero warnings.
- Format check passes.
- test:structure passes.
- Tests pass with >=70% coverage.

Versioning
- Changeset exists for every commit in the release range.
- Changeset versioning run successfully.

Documentation
- Release notes drafted from changesets.
- Any config changes documented.

## Versioning and changesets
Rules
- Each commit must have a changeset file.
- Version bump is derived from changesets: major/minor/patch.

Process
1. Run `npx changeset version`.
2. Review generated version bumps and changelog updates.
3. Commit version changes with proper message format.

## Release flow (ASCII)
```
feature/* -> develop -> qa -> main -> deploy
               |         |      |
               |         |      +-> release tag
               |         +-> QA sign-off
               +-> CI green
```

## Release runbook (full)
Pre‑release
- Confirm changesets for every commit in the release range.
- Run lint, format:check, test:structure, tests, build.
- QA signs off on the release candidate in qa branch.

Release
- Run changeset versioning.
- Tag release and push tags.
- Generate release notes from changeset entries.

Post‑release
- Monitor logs and error rates.
- Verify smoke tests on production.
- Prepare rollback plan if needed.

Rollback
- Redeploy last stable version.
- Record incident details.
- Add changeset for the fix.

## Rollback rules
When to rollback
- Release fails smoke tests.
- Production errors exceed acceptable thresholds.

Rollback steps
1. Redeploy last stable version.
2. Record incident details and root cause.
3. Patch and re‑release with new changeset.

## Evidence and artifacts
Required artifacts
- CI run link for release commit.
- Changeset summary.
- QA sign‑off note.

## References
- docs/workflows/git-workflow.md
- docs/workflows/ci.md
- docs/testing/strategy.md

Last updated: 2025-01-04
